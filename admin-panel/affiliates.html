<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ù Syst√®me d'Affiliation - Maxis Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        .affiliates-container {
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* Stats Overview */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card-large {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .stat-icon-large {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .stat-value-large {
            font-size: 2.2rem;
            font-weight: 700;
            color: #3b82f6;
        }
        
        .stat-label-large {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .stat-change {
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .stat-change.positive { color: #10b981; }
        .stat-change.negative { color: #ef4444; }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .tab {
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .tab.active {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Affiliates Table */
        .table-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .search-filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .search-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px 15px;
            color: white;
            min-width: 250px;
        }
        
        .filter-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px 15px;
            color: white;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        th {
            background: rgba(255, 255, 255, 0.03);
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .affiliate-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .affiliate-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        
        .affiliate-name {
            font-weight: 600;
        }
        
        .affiliate-code {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            font-family: monospace;
            background: rgba(0, 0, 0, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .status-inactive {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .tier-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .tier-bronze { background: rgba(180, 83, 9, 0.3); color: #fbbf24; }
        .tier-silver { background: rgba(156, 163, 175, 0.3); color: #e5e7eb; }
        .tier-gold { background: rgba(234, 179, 8, 0.3); color: #facc15; }
        .tier-platinum { background: rgba(100, 116, 139, 0.3); color: #cbd5e1; }
        .tier-diamond { background: rgba(59, 130, 246, 0.3); color: #60a5fa; }
        
        .actions-cell {
            display: flex;
            gap: 8px;
        }
        
        .btn-icon {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .btn-icon:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .btn-icon.pay:hover { background: #10b981; }
        .btn-icon.delete:hover { background: #ef4444; }
        
        /* Payout Cards */
        .payouts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .payout-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .payout-card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }
        
        .payout-amount {
            font-size: 1.8rem;
            font-weight: 700;
            color: #10b981;
        }
        
        .payout-status {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .payout-status.pending { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        .payout-status.paid { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .payout-status.processing { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        
        /* Settings Form */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }
        
        .settings-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .settings-card h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .form-control {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px 15px;
            color: white;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        /* Tier System */
        .tiers-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .tier-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .tier-info {
            flex: 1;
        }
        
        .tier-name {
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .tier-req {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .tier-commission {
            font-size: 1.3rem;
            font-weight: 700;
            color: #10b981;
        }
        
        /* Leaderboard */
        .leaderboard {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .leaderboard-rank {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
        }
        
        .rank-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; }
        .rank-2 { background: linear-gradient(135deg, #c0c0c0, #e5e7eb); color: #000; }
        .rank-3 { background: linear-gradient(135deg, #cd7f32, #fbbf24); color: #000; }
        .rank-other { background: rgba(255, 255, 255, 0.1); color: #fff; }
        
        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-header h2 {
            margin: 0;
        }
        
        .btn-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .btn-close:hover {
            color: white;
        }
        
        /* Action Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 2000;
            animation: slideIn 0.3s ease;
        }
        
        .toast.success { background: #10b981; }
        .toast.error { background: #ef4444; }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="nav-logo">ü§ù</span>
            <span>Affiliation</span>
        </div>
        <div class="nav-links">
            <a href="index.html">üìä Dashboard</a>
            <a href="users.html">üë• Utilisateurs</a>
            <a href="orders.html">üõçÔ∏è Commandes</a>
            <a href="tickets.html">üé´ Tickets</a>
            <a href="buttons.html">üîò Boutons</a>
            <a href="embeds.html">üì¶ Embeds</a>
            <a href="affiliates.html" class="active">ü§ù Affiliation</a>
            <a href="logs.html">üìú Logs</a>
        </div>
        <div class="nav-user">
            <span id="admin-name">Admin</span>
            <button class="btn-logout" onclick="logout()">D√©connexion</button>
        </div>
    </nav>

    <div class="affiliates-container">
        <!-- Header -->
        <div class="page-header">
            <h1 class="page-title">ü§ù Syst√®me d'Affiliation</h1>
            <p class="page-subtitle">G√©rez vos affili√©s, commissions et paiements</p>
        </div>

        <!-- Stats Overview -->
        <div class="stats-overview">
            <div class="stat-card-large">
                <div class="stat-icon-large">üë•</div>
                <div class="stat-value-large" id="stat-affiliates">0</div>
                <div class="stat-label-large">Affili√©s Actifs</div>
                <div class="stat-change positive">+12% ce mois</div>
            </div>
            <div class="stat-card-large">
                <div class="stat-icon-large">üí∞</div>
                <div class="stat-value-large" id="stat-revenue">‚Ç¨0</div>
                <div class="stat-label-large">Revenue G√©n√©r√©</div>
                <div class="stat-change positive">+23% ce mois</div>
            </div>
            <div class="stat-card-large">
                <div class="stat-icon-large">üéØ</div>
                <div class="stat-value-large" id="stat-conversions">0</div>
                <div class="stat-label-large">Conversions</div>
                <div class="stat-change positive">+8% ce mois</div>
            </div>
            <div class="stat-card-large">
                <div class="stat-icon-large">üí∏</div>
                <div class="stat-value-large" id="stat-pending">‚Ç¨0</div>
                <div class="stat-label-large">Paiements en Attente</div>
                <div class="stat-change negative">5 √† traiter</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('affiliates')">üë• Affili√©s</div>
            <div class="tab" onclick="switchTab('payouts')">üí∏ Paiements</div>
            <div class="tab" onclick="switchTab('leaderboard')">üèÜ Classement</div>
            <div class="tab" onclick="switchTab('settings')">‚öôÔ∏è Param√®tres</div>
        </div>

        <!-- Tab: Affiliates -->
        <div id="affiliates-tab" class="tab-content active">
            <div class="table-container">
                <div class="table-header">
                    <div class="search-filters">
                        <input type="text" class="search-input" placeholder="üîç Rechercher un affili√©..." id="search-affiliates">
                        <select class="filter-select" id="filter-tier">
                            <option value="">Tous les tiers</option>
                            <option value="bronze">Bronze</option>
                            <option value="silver">Silver</option>
                            <option value="gold">Gold</option>
                            <option value="platinum">Platinum</option>
                            <option value="diamond">Diamond</option>
                        </select>
                        <select class="filter-select" id="filter-status">
                            <option value="">Tous les statuts</option>
                            <option value="active">Actif</option>
                            <option value="pending">En attente</option>
                            <option value="inactive">Inactif</option>
                        </select>
                    </div>
                    <button class="btn-primary" onclick="openAddAffiliateModal()">+ Ajouter un Affili√©</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Affili√©</th>
                            <th>Code</th>
                            <th>Tier</th>
                            <th>Conversions</th>
                            <th>Revenue</th>
                            <th>Commission</th>
                            <th>Statut</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="affiliates-table">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab: Payouts -->
        <div id="payouts-tab" class="tab-content">
            <div class="table-container">
                <div class="table-header">
                    <h3>üí∏ Demandes de Paiement</h3>
                    <button class="btn-primary" onclick="processAllPayouts()">Traiter Tous</button>
                </div>
                <div class="payouts-grid" id="payouts-list">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>

        <!-- Tab: Leaderboard -->
        <div id="leaderboard-tab" class="tab-content">
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 25px;">
                <div class="leaderboard" id="leaderboard-list">
                    <!-- Populated by JS -->
                </div>
                <div>
                    <div class="settings-card">
                        <h3>üéÅ R√©compenses du Mois</h3>
                        <div style="margin-top: 15px;">
                            <div style="padding: 15px; background: rgba(255,215,0,0.1); border-radius: 8px; margin-bottom: 10px;">
                                <strong>ü•á Top 1</strong>
                                <p style="margin: 5px 0; color: rgba(255,255,255,0.8);">‚Ç¨100 + Badge Or</p>
                            </div>
                            <div style="padding: 15px; background: rgba(192,192,192,0.1); border-radius: 8px; margin-bottom: 10px;">
                                <strong>ü•à Top 2</strong>
                                <p style="margin: 5px 0; color: rgba(255,255,255,0.8);">‚Ç¨50 + Badge Argent</p>
                            </div>
                            <div style="padding: 15px; background: rgba(205,127,50,0.1); border-radius: 8px; margin-bottom: 10px;">
                                <strong>ü•â Top 3</strong>
                                <p style="margin: 5px 0; color: rgba(255,255,255,0.8);">‚Ç¨25 + Badge Bronze</p>
                            </div>
                            <div style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                                <strong>üéØ Top 10</strong>
                                <p style="margin: 5px 0; color: rgba(255,255,255,0.8);">Pro Plan 1 mois offert</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Settings -->
        <div id="settings-tab" class="tab-content">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3>üí∞ Commissions par D√©faut</h3>
                    <div class="form-group">
                        <label>Commission de Base (%)</label>
                        <input type="number" class="form-control" id="base-commission" value="15" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label>Commission sur Upsells (%)</label>
                        <input type="number" class="form-control" id="upsell-commission" value="10" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label>D√©lai de Validation (jours)</label>
                        <input type="number" class="form-control" id="validation-days" value="30" min="0">
                        <small style="color: rgba(255,255,255,0.5);">D√©lai avant qu'une commission soit valid√©e</small>
                    </div>
                </div>

                <div class="settings-card">
                    <h3>üèÜ Syst√®me de Tiers</h3>
                    <div class="tiers-list">
                        <div class="tier-item">
                            <span class="tier-badge tier-bronze">BRONZE</span>
                            <div class="tier-info">
                                <div class="tier-name">Bronze</div>
                                <div class="tier-req">0-9 conversions</div>
                            </div>
                            <div class="tier-commission">15%</div>
                        </div>
                        <div class="tier-item">
                            <span class="tier-badge tier-silver">SILVER</span>
                            <div class="tier-info">
                                <div class="tier-name">Silver</div>
                                <div class="tier-req">10-49 conversions</div>
                            </div>
                            <div class="tier-commission">20%</div>
                        </div>
                        <div class="tier-item">
                            <span class="tier-badge tier-gold">GOLD</span>
                            <div class="tier-info">
                                <div class="tier-name">Gold</div>
                                <div class="tier-req">50-99 conversions</div>
                            </div>
                            <div class="tier-commission">25%</div>
                        </div>
                        <div class="tier-item">
                            <span class="tier-badge tier-platinum">PLATINUM</span>
                            <div class="tier-info">
                                <div class="tier-name">Platinum</div>
                                <div class="tier-req">100-499 conversions</div>
                            </div>
                            <div class="tier-commission">30%</div>
                        </div>
                        <div class="tier-item">
                            <span class="tier-badge tier-diamond">DIAMOND</span>
                            <div class="tier-info">
                                <div class="tier-name">Diamond</div>
                                <div class="tier-req">500+ conversions</div>
                            </div>
                            <div class="tier-commission">35%</div>
                        </div>
                    </div>
                </div>

                <div class="settings-card">
                    <h3>üí≥ Paiements</h3>
                    <div class="form-group">
                        <label>Seuil Minimum de Paiement (‚Ç¨)</label>
                        <input type="number" class="form-control" id="min-payout" value="50" min="0">
                    </div>
                    <div class="form-group">
                        <label>Fr√©quence des Paiements</label>
                        <select class="form-control" id="payout-frequency">
                            <option value="weekly">Hebdomadaire</option>
                            <option value="biweekly">Bi-mensuel</option>
                            <option value="monthly" selected>Mensuel</option>
                            <option value="on_request">Sur demande</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="auto-payout" checked>
                            <span>Paiement automatique d√®s le seuil atteint</span>
                        </label>
                    </div>
                </div>

                <div class="settings-card">
                    <h3>üîí Conditions & R√®gles</h3>
                    <div class="form-group">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="self-referral" checked>
                            <span>Interdire l'auto-parrainage</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="cookie-tracking" checked>
                            <span>Tracking par cookie (30 jours)</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="approval-required">
                            <span>Approbation manuelle des affili√©s</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label>Email de Contact Affiliation</label>
                        <input type="email" class="form-control" id="affiliate-email" value="affiliates@shellia.ai">
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 25px; text-align: right;">
                <button class="btn-primary" onclick="saveSettings()">üíæ Sauvegarder les Param√®tres</button>
            </div>
        </div>
    </div>

    <!-- Add Affiliate Modal -->
    <div class="modal-overlay" id="add-affiliate-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï Ajouter un Affili√©</h2>
                <button class="btn-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>Utilisateur Discord</label>
                <input type="text" class="form-control" id="new-affiliate-user" placeholder="@username ou ID">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Code Promo (optionnel)</label>
                    <input type="text" class="form-control" id="new-affiliate-code" placeholder="ALICE20">
                </div>
                <div class="form-group">
                    <label>Commission Sp√©ciale (%)</label>
                    <input type="number" class="form-control" id="new-affiliate-commission" placeholder="15">
                </div>
            </div>
            <div class="form-group">
                <label>Tier Initial</label>
                <select class="form-control" id="new-affiliate-tier">
                    <option value="bronze">Bronze (15%)</option>
                    <option value="silver">Silver (20%)</option>
                    <option value="gold">Gold (25%)</option>
                    <option value="platinum">Platinum (30%)</option>
                    <option value="diamond">Diamond (35%)</option>
                </select>
            </div>
            <div class="form-group">
                <label class="checkbox-wrapper">
                    <input type="checkbox" id="new-affiliate-vip">
                    <span>Affili√© VIP (avantages sp√©ciaux)</span>
                </label>
            </div>
            <div style="margin-top: 25px; display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn-secondary" onclick="closeModal()">Annuler</button>
                <button class="btn-primary" onclick="addAffiliate()">Ajouter</button>
            </div>
        </div>
    </div>

    <script>
        // Data
        let affiliates = [];
        let payouts = [];
        let leaderboard = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadStats();
            loadAffiliates();
            loadPayouts();
            loadLeaderboard();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('search-affiliates').addEventListener('input', filterAffiliates);
            document.getElementById('filter-tier').addEventListener('change', filterAffiliates);
            document.getElementById('filter-status').addEventListener('change', filterAffiliates);
        }

        // Tabs
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
        }

        // Stats
        function loadStats() {
            document.getElementById('stat-affiliates').textContent = '45';
            document.getElementById('stat-revenue').textContent = '‚Ç¨12.4K';
            document.getElementById('stat-conversions').textContent = '892';
            document.getElementById('stat-pending').textContent = '‚Ç¨2.3K';
        }

        // Affiliates
        function loadAffiliates() {
            affiliates = [
                { id: 1, name: 'Alice', avatar: 'A', code: 'ALICE20', tier: 'diamond', conversions: 567, revenue: 8940, commission: 3129, status: 'active' },
                { id: 2, name: 'Bob', avatar: 'B', code: 'BOB15', tier: 'platinum', conversions: 234, revenue: 3890, commission: 1167, status: 'active' },
                { id: 3, name: 'Charlie', avatar: 'C', code: 'CHARLIE10', tier: 'gold', conversions: 89, revenue: 1450, commission: 362, status: 'active' },
                { id: 4, name: 'Diana', avatar: 'D', code: 'DIANA25', tier: 'silver', conversions: 34, revenue: 580, commission: 116, status: 'pending' },
                { id: 5, name: 'Eve', avatar: 'E', code: 'EVE2024', tier: 'bronze', conversions: 12, revenue: 198, commission: 29, status: 'active' }
            ];
            renderAffiliates(affiliates);
        }

        function renderAffiliates(data) {
            const tbody = document.getElementById('affiliates-table');
            tbody.innerHTML = data.map(a => `
                <tr>
                    <td>
                        <div class="affiliate-info">
                            <div class="affiliate-avatar">${a.avatar}</div>
                            <div>
                                <div class="affiliate-name">${a.name}</div>
                                <div style="font-size: 0.8rem; color: rgba(255,255,255,0.5);">ID: ${a.id}</div>
                            </div>
                        </div>
                    </td>
                    <td><span class="affiliate-code">${a.code}</span></td>
                    <td><span class="tier-badge tier-${a.tier}">${a.tier.toUpperCase()}</span></td>
                    <td>${a.conversions}</td>
                    <td>‚Ç¨${a.revenue.toLocaleString()}</td>
                    <td>‚Ç¨${a.commission.toLocaleString()}</td>
                    <td><span class="status-badge status-${a.status}">${a.status}</span></td>
                    <td>
                        <div class="actions-cell">
                            <button class="btn-icon" onclick="viewAffiliate(${a.id})" title="Voir">üëÅÔ∏è</button>
                            <button class="btn-icon pay" onclick="payAffiliate(${a.id})" title="Payer">üí∏</button>
                            <button class="btn-icon" onclick="editAffiliate(${a.id})" title="Modifier">‚úèÔ∏è</button>
                            <button class="btn-icon delete" onclick="deleteAffiliate(${a.id})" title="Supprimer">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function filterAffiliates() {
            const search = document.getElementById('search-affiliates').value.toLowerCase();
            const tier = document.getElementById('filter-tier').value;
            const status = document.getElementById('filter-status').value;
            
            let filtered = affiliates.filter(a => {
                const matchSearch = a.name.toLowerCase().includes(search) || a.code.toLowerCase().includes(search);
                const matchTier = !tier || a.tier === tier;
                const matchStatus = !status || a.status === status;
                return matchSearch && matchTier && matchStatus;
            });
            
            renderAffiliates(filtered);
        }

        // Payouts
        function loadPayouts() {
            payouts = [
                { id: 1, affiliate: 'Alice', amount: 850, status: 'pending', method: 'PayPal', date: '2024-01-15' },
                { id: 2, affiliate: 'Bob', amount: 420, status: 'pending', method: 'Bank Transfer', date: '2024-01-14' },
                { id: 3, affiliate: 'Charlie', amount: 180, status: 'processing', method: 'PayPal', date: '2024-01-13' }
            ];
            renderPayouts();
        }

        function renderPayouts() {
            const container = document.getElementById('payouts-list');
            container.innerHTML = payouts.map(p => `
                <div class="payout-card">
                    <div class="payout-card-header">
                        <div>
                            <strong>${p.affiliate}</strong>
                            <div style="font-size: 0.8rem; color: rgba(255,255,255,0.6);">${p.method} ‚Ä¢ ${p.date}</div>
                        </div>
                        <div class="payout-status ${p.status}">${p.status}</div>
                    </div>
                    <div class="payout-amount">‚Ç¨${p.amount}</div>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        ${p.status === 'pending' ? `
                            <button class="btn-primary" onclick="processPayout(${p.id})">üí∏ Payer</button>
                            <button class="btn-secondary" onclick="rejectPayout(${p.id})">‚ùå Refuser</button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Leaderboard
        function loadLeaderboard() {
            leaderboard = affiliates.sort((a, b) => b.revenue - a.revenue).slice(0, 10);
            renderLeaderboard();
        }

        function renderLeaderboard() {
            const container = document.getElementById('leaderboard-list');
            container.innerHTML = leaderboard.map((a, i) => `
                <div class="leaderboard-item">
                    <div class="leaderboard-rank rank-${i < 3 ? i + 1 : 'other'}">${i + 1}</div>
                    <div class="affiliate-avatar">${a.avatar}</div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600;">${a.name}</div>
                        <div style="font-size: 0.8rem; color: rgba(255,255,255,0.6);">${a.conversions} conversions</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: 700; color: #10b981;">‚Ç¨${a.revenue.toLocaleString()}</div>
                        <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">‚Ç¨${a.commission.toLocaleString()} commission</div>
                    </div>
                </div>
            `).join('');
        }

        // Actions
        function openAddAffiliateModal() {
            document.getElementById('add-affiliate-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('add-affiliate-modal').style.display = 'none';
        }

        function addAffiliate() {
            const name = document.getElementById('new-affiliate-user').value;
            if (!name) {
                showToast('Veuillez entrer un utilisateur', 'error');
                return;
            }
            
            showToast(`‚úÖ Affili√© ${name} ajout√© !`, 'success');
            closeModal();
        }

        function viewAffiliate(id) {
            showToast(`üëÅÔ∏è Vue d√©taill√©e de l'affili√© ${id}`, 'success');
        }

        function payAffiliate(id) {
            showToast(`üí∏ Paiement initi√© pour l'affili√© ${id}`, 'success');
        }

        function editAffiliate(id) {
            showToast(`‚úèÔ∏è √âdition de l'affili√© ${id}`, 'success');
        }

        function deleteAffiliate(id) {
            if (confirm('Supprimer cet affili√© ?')) {
                affiliates = affiliates.filter(a => a.id !== id);
                renderAffiliates(affiliates);
                showToast('üóëÔ∏è Affili√© supprim√©', 'success');
            }
        }

        function processPayout(id) {
            showToast(`üí∏ Paiement #${id} trait√©`, 'success');
        }

        function rejectPayout(id) {
            showToast(`‚ùå Paiement #${id} refus√©`, 'error');
        }

        function processAllPayouts() {
            if (confirm('Traiter tous les paiements en attente ?')) {
                showToast('üí∏ Tous les paiements ont √©t√© trait√©s', 'success');
            }
        }

        function saveSettings() {
            showToast('üíæ Param√®tres sauvegard√©s', 'success');
        }

        // Utilities
        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function logout() {
            localStorage.removeItem('admin_session');
            window.location.href = 'login.html';
        }

        // Close modal on outside click
        document.getElementById('add-affiliate-modal').addEventListener('click', (e) => {
            if (e.target.id === 'add-affiliate-modal') closeModal();
        });
    </script>
</body>
</html>
